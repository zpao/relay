<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-v1.4.1 plugin-docs plugin-id-default docs-doc-id-testing-relay-components">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Testing Relay Components | Relay</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://github.zpao.com/relay/img/relay.png"><meta data-rh="true" name="twitter:image" content="https://github.zpao.com/relay/img/relay.png"><meta data-rh="true" property="og:url" content="https://github.zpao.com/relay/docs/v1.4.1/testing-relay-components/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v1.4.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v1.4.1"><meta data-rh="true" name="docsearch:version" content="v1.4.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v1.4.1"><meta data-rh="true" property="og:title" content="Testing Relay Components | Relay"><meta data-rh="true" name="description" content="The purpose of this document is to cover the Relay APIs for testing Relay components."><meta data-rh="true" property="og:description" content="The purpose of this document is to cover the Relay APIs for testing Relay components."><link data-rh="true" rel="icon" href="/relay/img/favicon.png"><link data-rh="true" rel="canonical" href="https://github.zpao.com/relay/docs/v1.4.1/testing-relay-components/"><link data-rh="true" rel="alternate" href="https://github.zpao.com/relay/docs/v1.4.1/testing-relay-components/" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.zpao.com/relay/docs/v1.4.1/testing-relay-components/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/relay/blog/rss.xml" title="Relay RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/relay/blog/atom.xml" title="Relay Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-DCSC7FDGL5","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DCSC7FDGL5"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DCSC7FDGL5",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Relay" href="/relay/opensearch.xml"><link rel="stylesheet" href="/relay/assets/css/styles.e5a415b3.css">
<link rel="preload" href="/relay/assets/js/runtime~main.49921073.js" as="script">
<link rel="preload" href="/relay/assets/js/main.f6618890.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>

<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/relay/"><b class="navbar__title text--truncate">Relay</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/relay/docs/">Docs</a><a class="navbar__item navbar__link" href="/relay/blog/">Blog</a><a class="navbar__item navbar__link" href="/relay/help/">Help</a><a href="https://github.com/facebook/relay" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/relay/docs/v1.4.1/">v1.4.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/relay/docs/next/">Next ðŸš§</a></li><li><a class="dropdown__link" href="/relay/docs/">v16.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v15.0.0/">v15.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v14.0.0/">v14.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v13.0.0/">v13.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v12.0.0/">v12.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v11.0.0/">v11.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v10.1.3/testing-relay-components/">v10.1.3</a></li><li><a class="dropdown__link" href="/relay/docs/v10.1.2/testing-relay-components/">v10.1.2</a></li><li><a class="dropdown__link" href="/relay/docs/v10.1.1/testing-relay-components/">v10.1.1</a></li><li><a class="dropdown__link" href="/relay/docs/v10.1.0/testing-relay-components/">v10.1.0</a></li><li><a class="dropdown__link" href="/relay/docs/v10.0.1/testing-relay-components/">v10.0.1</a></li><li><a class="dropdown__link" href="/relay/docs/v10.0.0/testing-relay-components/">v10.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v9.1.0/testing-relay-components/">v9.1.0</a></li><li><a class="dropdown__link" href="/relay/docs/v9.0.0/testing-relay-components/">v9.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v8.0.0/testing-relay-components/">v8.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v7.1.0/testing-relay-components/">v7.1.0</a></li><li><a class="dropdown__link" href="/relay/docs/v7.0.0/testing-relay-components/">v7.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v6.0.0/testing-relay-components/">v6.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v5.0.0/testing-relay-components/">v5.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v4.0.0/testing-relay-components/">v4.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v3.0.0/testing-relay-components/">v3.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v2.0.0/testing-relay-components/">v2.0.0</a></li><li><a class="dropdown__link" href="/relay/docs/v1.7.0/testing-relay-components/">v1.7.0</a></li><li><a class="dropdown__link" href="/relay/docs/v1.6.2/testing-relay-components/">v1.6.2</a></li><li><a class="dropdown__link" href="/relay/docs/v1.6.1/testing-relay-components/">v1.6.1</a></li><li><a class="dropdown__link" href="/relay/docs/v1.6.0/testing-relay-components/">v1.6.0</a></li><li><a class="dropdown__link" href="/relay/docs/v1.5.0/testing-relay-components/">v1.5.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/relay/docs/v1.4.1/testing-relay-components/">v1.4.1</a></li><li><a class="dropdown__link" href="/relay/versions/">All versions</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Relay<!-- --> <b>v1.4.1</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/relay/docs/">latest version</a></b> (<!-- -->v16.0.0<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><span class="theme-doc-version-badge badge badge--secondary">Version: v1.4.1</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Testing Relay Components</h1></header><p>The purpose of this document is to cover the Relay APIs for testing Relay components.</p><p>The content is focused mostly on Jest unit-tests (testing individual components) and integration tests (testing a combination of components), but these testing tools may be applied in different cases: screenshot-tests, production smoke-tests, fuzz-tests, e2e test, etc.</p><p>The benefits of writing Jest tests:</p><ul><li>In general, it improves the stability of the system. Flow really helps with catching a various set of JavaScript errors, but it is still possible to introduce regressions to the components. Unit-tests may help to find, reproduce, and fix those regressions, and prevent them in the future.</li><li>It simplifies the refactoring process: when properly written (testing public interface, not implementation), tests really help with changing the internal implementation of the components.</li><li>It may speed up and improve the development workflow. Some people may call it Test Driven Development (TM). But essentially it&#x27;s just writing tests for public interfaces of your components, and then writing the components that are implementing those interfaces. Jest --watch mode is really shining in this case.</li><li>It will simplify the onboarding process for new developers, having tests really help to ramp up on the new code base, fixing bugs, and delivering features.</li></ul><p>One thing to note: while Jest unit and integration tests will help improve the stability of the system, they should be considered as a part of a bigger stability infrastructure with multiple layers of automated testing: flow, e2e, screenshot and performance tests.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing-with-relay">Testing with Relay<a class="hash-link" href="#testing-with-relay" title="Direct link to heading">â€‹</a></h2><p>Testing applications that are using Relay may be challenging, because of the additional data fetching layer that is wrapping the actual product code.</p><p>It&#x27;s not always easy to understand the mechanics of all processes that are happening behind Relay, and how to properly handle interactions with the framework.</p><p>Fortunately, we have tools that aim to simplify the process of writing tests for Relay components, by providing imperative APIs for controlling the request/response flow and additional API for mock data generation.</p><p>There are two main modules that you may use in your tests:</p><ul><li><code>createMockEnvironment(options): RelayMockEnvironment</code></li><li><code>MockPayloadGenerator</code> and <code>@relay_test_operation</code> directive</li></ul><p>With <code>createMockEnvironment</code>, you are able to create an instance of <code>RelayMockEnvironment</code>, a Relay environment specifically for your tests. The instance created by <code>createMockEnvironment</code> is implementing the Relay Environment Interface and it also has an additional Mock layer, with methods that allow to resolve/reject and control the flow of operations (queries/mutations/subscriptions).</p><p>The main purpose of <code>MockPayloadGenerator</code> is to improve the process of creating and maintaining the mock data for tested components.</p><p>One of the patterns you may see in the tests for Relay components: 95% of the test code is the test preparation: the gigantic mock object with dummy data, manually created, or just a copy of a sample server response that needs to be passed as the network response. The remaining 5% is the actual test. As a result, people don&#x27;t test much. It&#x27;s hard to create and manage all these dummy payloads for different cases. Hence, writing tests is time-consuming and painful to maintain.</p><p>With the <code>MockPayloadGenerator</code> and <code>@relay_test_operation</code>, we want to get rid of this pattern and switch the developer&#x27;s focus from the preparation of the test to the actual testing.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="relaymockenvironment-api-overview"><code>RelayMockEnvironment</code> API Overview<a class="hash-link" href="#relaymockenvironment-api-overview" title="Direct link to heading">â€‹</a></h2><p><code>RelayMockEnvironment</code> is a special version of Relay Environment with an additional API methods for controlling the operation flow: resolving and rejection operations, providing incremental payloads for subscriptions, working with cache.</p><ul><li>Methods for finding operations executed on the environment<ul><li><code>getAllOperations()</code> - get all operation executed during the test by the current time</li><li><code>findOperation(findFn =&gt; boolean) </code>- find particular operation in the list of all executed operations, this method will throw, if operation is not available. Maybe useful to find a particular operation when multiple operations executed at the same time</li><li><code>getMostRecentOperation() -</code> return the most recent operation, this method will throw if no operations were executed prior this call.</li></ul></li><li>Methods for resolving or rejecting operations<ul><li><code>nextValue(request | operation, data)</code> - provide payload for operation(request), but not complete request. Practically useful when testing incremental updates and subscriptions</li><li><code>complete(request | operation)</code>  - complete the operation, no more payloads are expected for this operation, when it&#x27;s completed.</li><li><code>resolve(request | operation, data)</code> - resolve the request with provided GraphQL response. Essentially, it&#x27;s nextValue(...) and complete(...)</li><li><code>reject(request | operation, error)</code> - reject the request with particular error</li><li><code>resolveMostRecentOperation(data | operation =&gt; data)</code> - resolve and getMostRecentOperation work together</li><li><code>rejectMostRecentOperation(error | operation =&gt; error)</code>  - reject and getMostRecentOperation work together</li><li><code>queueOperationResolver(operation =&gt; data | error)</code> - adds an OperationResolver function to the queue, those methods will be used to resolve/reject operations as they appear</li></ul></li><li>Additional utility methods<ul><li><code>isLoading(request | operation)</code> - will return <code>true</code> if operations have not been completed, yet.</li><li><code>cachePayload(request | operation, variables, payload)</code> - will add payload to QueryResponse cache</li><li><code>clearCache() </code>- will clear <code>QueryResponse</code> cache</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="mock-payload-generator-and-relay_test_operation-directive">Mock Payload Generator and <code>@relay_test_operation</code> Directive<a class="hash-link" href="#mock-payload-generator-and-relay_test_operation-directive" title="Direct link to heading">â€‹</a></h2><p><code>MockPayloadGenerator</code> may drastically simplify the process of creating and maintaining mock data for your tests. <code>MockPayloadGenerator</code> is the module that can generate dummy data for the selection that you have in your operation. There is an API to modify the generated data - Mock Resolvers. With Mock Resolvers, you may adjust the data for your needs. Collection of Mock Resolvers it&#x27;s an object where keys are names of GraphQL types (ID, String, User, Feedback, Comment, etc), and values are functions that will return the default data for the type.</p><p>Example of a simple Mock Resolver:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token constant" style="color:black">ID</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Return mock value for a scalar filed with type ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;my-id&#x27;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Every scalar field with type String will have this default value</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;Lorem Ipsum&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It is possible to define more resolvers for Object types:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// This will be the default values for User object in the query response</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function maybe-class-name" style="color:black">User</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token literal-property property" style="color:black">id</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token number" style="color:black">1000</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token literal-property property" style="color:black">name</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;Alice&quot;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token literal-property property" style="color:black">profile_picture</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token literal-property property" style="color:black">uri</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&quot;http://my-image...&quot;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mock-resolver-context">Mock Resolver Context<a class="hash-link" href="#mock-resolver-context" title="Direct link to heading">â€‹</a></h3><p>The first argument of the MockResolver is the object that contains Mock Resolver Context. It is possible to return dynamic values from mock resolvers based on the context - for instance, name or alias of the field, a path in the selection, arguments, or parent type.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token known-class-name class-name">String</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">context</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;zip&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;94025&#x27;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">path</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">!=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">&amp;&amp;</span><span class="token plain"> context</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">path</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">join</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;.&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;node.actor.name&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;Current Actor Name&#x27;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">parentType</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;Image&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">&amp;&amp;</span><span class="token plain"> context</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;uri&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">       </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;http://my-image.url&#x27;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id-generation">ID Generation<a class="hash-link" href="#id-generation" title="Direct link to heading">â€‹</a></h3><p>The second argument of the Mock Resolver its a function that will generate a sequence of integers, useful to generate unique IDs in the tests:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// will generate strings &quot;my-id-1&quot;, &quot;my-id-2&quot;, etc.</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token constant" style="color:black">ID</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">_</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> generateId</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">     </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string string" style="color:#65822b">my-id-</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#b58a5e">${</span><span class="token template-string interpolation function" style="color:black">generateId</span><span class="token template-string interpolation punctuation" style="color:#b58a5e">(</span><span class="token template-string interpolation punctuation" style="color:#b58a5e">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#b58a5e">}</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="relay_test_operation"><code>@relay_test_operation</code><a class="hash-link" href="#relay_test_operation" title="Direct link to heading">â€‹</a></h3><p>Most of GraphQL type information for a specific field in the selection is not available during Relay runtime. By default, Relay, cannot get type information for a scalar field in the selection, or an interface type of the object.</p><p>Operations with the <code>@relay_test_operation</code> directive will have additional metadata that will contain GraphQL type info for fields in the operation&#x27;s selection. And it will improve the quality of the generated data. You also will be able to define Mock resolvers for Scalar (not only ID and String) and Abstract types:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function maybe-class-name" style="color:black">Float</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:black">123.456</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token known-class-name class-name">Boolean</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">context</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">context</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;can_edit&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:black">true</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:black">false</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function maybe-class-name" style="color:black">Node</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token literal-property property" style="color:black">__typename</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;User&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token literal-property property" style="color:black">id</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;my-user-id&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a class="hash-link" href="#examples" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="relay-component-test">Relay Component Test<a class="hash-link" href="#relay-component-test" title="Direct link to heading">â€‹</a></h3><p>Using <code>createMockEnvironment</code> and <code>MockPayloadGenerator</code> allows writing concise tests for components that are using Relay Containers and Renderers. Both those modules can be imported from <code>relay-test-utils</code>.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// Say you have a component with the QueryRenderer</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">MyAwesomeViewRoot</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;MyAwesomeViewRoot&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;relay-test-utils&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Relay may trigger 3 different states</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// for this component: Loading, Error, Data Loaded</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Here is examples of tests for those states.</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Loading State&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renderer </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReactTestRenderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">create</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MyAwesomeViewRoot</span><span class="token plain"> environment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Here we just verify that the spinner is rendered</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    renderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">root</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">find</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">node</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> node</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">[</span><span class="token string" style="color:#65822b">&#x27;data-testid&#x27;</span><span class="token punctuation" style="color:#b58a5e">]</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;spinner&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBeDefined</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Data Render&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renderer </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReactTestRenderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">create</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MyAwesomeViewRoot</span><span class="token plain"> environment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">resolveMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">operation</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// At this point operation will be resolved</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// and the data for a query will be available in the store</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    renderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">root</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">find</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">node</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> node</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">[</span><span class="token string" style="color:#65822b">&#x27;data-testid&#x27;</span><span class="token punctuation" style="color:#b58a5e">]</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;myButton&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBeDefined</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Error State&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renderer </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReactTestRenderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">create</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MyAwesomeViewRoot</span><span class="token plain"> environment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Error can be simulated with `rejectMostRecentOperation`</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">rejectMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Uh-oh&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    renderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">root</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">find</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">item</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">testID</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;errorMessage&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBeDefined</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fragment-container-tests">Fragment Container Tests<a class="hash-link" href="#fragment-container-tests" title="Direct link to heading">â€‹</a></h3><p>Essentially, in the example above, <code>resolveMostRecentOperation</code> will generate data for all child fragment containers (pagination, refetch). Usually, the Root Components container may have many child fragment components and you may want to exercise a specific Fragment Container. The solution for that would be to wrap your fragment container with the QueryRenderer that renders a Query that&#x27;s spreads fragments from your fragment container.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Fragment Container&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:black">TestRenderer</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">QueryRenderer</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      environment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      query</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">query</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql definition-query function" style="color:black">TestQuery</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql directive function" style="color:black">@relay_test_operation</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">myData</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql property-query">node</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">id</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#65822b">&quot;test-id&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">            </span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string graphql language-graphql fragment function" style="color:black">MyFragment</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      variables</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      render</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter punctuation" style="color:#b58a5e">{</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> props</span><span class="token parameter punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MyFragmentContainer</span><span class="token plain"> myData</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">myData</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> error</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;Loading...&#x27;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renderer </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReactTestRenderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">create</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">TestRenderer</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">resolveMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">operation</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">renderer</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toMatchSnapshot</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pagination-container-test">Pagination Container Test<a class="hash-link" href="#pagination-container-test" title="Direct link to heading">â€‹</a></h3><p>Essentially, tests for Pagination container are not different from Fragment Container tests. We can also do more here. We can actually see how the pagination works by asserting the behavior of our components when performing pagination (load more, refetch).</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// Pagination Example</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Pagination Container&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:black">TestRenderer</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">QueryRenderer</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      environment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      query</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">query</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql definition-query function" style="color:black">TestQuery</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql directive function" style="color:black">@relay_test_operation</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">myConnection</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql property-query">node</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">id</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#65822b">&quot;test-id&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">            </span><span class="token template-string graphql language-graphql object">connection</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">              </span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string graphql language-graphql fragment function" style="color:black">MyConnectionFragment</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">            </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      variables</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      render</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter punctuation" style="color:#b58a5e">{</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> props</span><span class="token parameter punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MyPaginationContainer</span><span class="token plain"> connection</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">myConnection</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">connection</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> error</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;Loading...&#x27;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renderer </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReactTestRenderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">create</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">TestRenderer</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">resolveMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">operation</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token constant" style="color:black">ID</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">_</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> generateId</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Why we&#x27;re doing this?</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// To make sure that we will generate a different set of ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// for elements on first page and the second page.</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string string" style="color:#65822b">first-page-id-</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#b58a5e">${</span><span class="token template-string interpolation function" style="color:black">generateId</span><span class="token template-string interpolation punctuation" style="color:#b58a5e">(</span><span class="token template-string interpolation punctuation" style="color:#b58a5e">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#b58a5e">}</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token function maybe-class-name" style="color:black">PageInfo</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token literal-property property" style="color:black">has_next_page</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token boolean" style="color:black">true</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Let&#x27;s find a `loadMore` button and click on it to initiate pagination request, for example</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> loadMore </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> renderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">root</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">find</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">node</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> node</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">[</span><span class="token string" style="color:#65822b">&#x27;data-testid&#x27;</span><span class="token punctuation" style="color:#b58a5e">]</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;loadMore&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">loadMore</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">disabled</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBe</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token boolean" style="color:black">false</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  loadMore</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">onClick</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">resolveMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">operation</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token constant" style="color:black">ID</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">_</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> generateId</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// See, the second page IDs will be different</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string string" style="color:#65822b">second-page-id-</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#b58a5e">${</span><span class="token template-string interpolation function" style="color:black">generateId</span><span class="token template-string interpolation punctuation" style="color:#b58a5e">(</span><span class="token template-string interpolation punctuation" style="color:#b58a5e">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#b58a5e">}</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token function maybe-class-name" style="color:black">PageInfo</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// And the button should be disabled, now. Probably.</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token literal-property property" style="color:black">has_next_page</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> </span><span class="token boolean" style="color:black">false</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">loadMore</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">disabled</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBe</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token boolean" style="color:black">true</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="refetch-container">Refetch Container<a class="hash-link" href="#refetch-container" title="Direct link to heading">â€‹</a></h3><p>We can use similar approach here with wrapping container with Query Renderer. And for the sake of completeness, we will add example here:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Refetch Container&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:black">TestRenderer</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">QueryRenderer</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      environment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      query</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql keyword" style="color:#00009f">query</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql definition-query function" style="color:black">TestQuery</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql directive function" style="color:black">@relay_test_operation</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">myData</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql property-query">node</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">(</span><span class="token template-string graphql language-graphql attr-name" style="color:#2a6883">id</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">:</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql string" style="color:#65822b">&quot;test-id&quot;</span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">)</span><span class="token template-string graphql language-graphql"> </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">{</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">            </span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string graphql language-graphql fragment function" style="color:black">MyRefetchableFragment</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">          </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">        </span><span class="token template-string graphql language-graphql punctuation" style="color:#b58a5e">}</span><span class="token template-string graphql language-graphql"></span><br></span><span class="token-line" style="color:black"><span class="token template-string graphql language-graphql">      </span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      variables</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      render</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter punctuation" style="color:#b58a5e">{</span><span class="token parameter">error</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> props</span><span class="token parameter punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MyRefetchContainer</span><span class="token plain"> myData</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">myData</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">error</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">          </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> error</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">message</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;Loading...&#x27;</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renderer </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReactTestRenderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">create</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">TestRenderer</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">resolveMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">operation</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Assuming we have refetch button in the Container</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> refetchButton </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> renderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">root</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">find</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">node</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> node</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">[</span><span class="token string" style="color:#65822b">&#x27;data-testid&#x27;</span><span class="token punctuation" style="color:#b58a5e">]</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;refetch&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// This should trigger the `refetch`</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  refetchButton</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">onClick</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">resolveMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">operation</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// We can customize mock resolvers, to change the output of the refetch query</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// expect(renderer).toMatchSnapshot();</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mutations">Mutations<a class="hash-link" href="#mutations" title="Direct link to heading">â€‹</a></h3><p>Mutations itself are operations so we can test them independently (unit-test) for specific mutation, or in combination with the view from which this mutation is called.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// Say, you have a mutation function</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:black">sendMutation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">environment</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> onCompleted</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> onError</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> variables</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">commitMutation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token literal-property property" style="color:black">mutation</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    onCompleted</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    onError</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    variables</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Example test may be written like so</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;it should send mutation&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> onCompleted </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> jest</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">fn</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">sendMutation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> onCompleted</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> jest</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">fn</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> operation </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">getMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">resolve</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    operation</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">onCompleted</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBeCalled</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="subscription">Subscription<a class="hash-link" href="#subscription" title="Direct link to heading">â€‹</a></h3><p>We can test subscription in a similar way we test mutations</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// Example subscribe function</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:black">subscribe</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">environment</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> onNext</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> onError</span><span class="token parameter punctuation" style="color:#b58a5e">,</span><span class="token parameter"> variables</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">requestSubscription</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token literal-property property" style="color:black">subscription</span><span class="token operator" style="color:#b58a5e">:</span><span class="token plain"> graphql</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token template-string graphql language-graphql operator" style="color:#b58a5e">...</span><span class="token template-string template-punctuation string" style="color:#65822b">`</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    onNext</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    onError</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    variables</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Example test may be written like so</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;it should subscribe&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> onNext </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> jest</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">fn</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">subscribe</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> onNext</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> jest</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">fn</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> operation </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">getMostRecentOperation</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">nextValue</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    operation</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">onNext</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBeCalled</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-with-queueoperationresolver">Example with <code>queueOperationResolver</code><a class="hash-link" href="#example-with-queueoperationresolver" title="Direct link to heading">â€‹</a></h3><p>With <code>queueOpeararionResolver</code>, it possible to define responses for operations that will be executed on the environment</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:black;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:black"><span class="token comment" style="color:#999988;font-style:italic">// Say you have a component with the QueryRenderer</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">MyAwesomeViewRoot</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;MyAwesomeViewRoot&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">require</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;relay-test-utils&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Data Render&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">queueOperationResolver</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">operation</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token maybe-class-name">MockPayloadGenerator</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">generate</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">operation</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renderer </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReactTestRenderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">create</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MyAwesomeViewRoot</span><span class="token plain"> environment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// At this point operation will be resolved</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// and the data for a query will be available in the store</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    renderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">root</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">find</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">node</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> node</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">[</span><span class="token string" style="color:#65822b">&#x27;data-testid&#x27;</span><span class="token punctuation" style="color:#b58a5e">]</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">===</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;myButton&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBeDefined</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token function" style="color:black">test</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Error State&#x27;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> environment </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token function" style="color:black">createMockEnvironment</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  environment</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">mock</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">queueOperationResolver</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Error</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token string" style="color:#65822b">&#x27;Uh-oh&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> renderer </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token maybe-class-name">ReactTestRenderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">create</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    </span><span class="token operator" style="color:#b58a5e">&lt;</span><span class="token maybe-class-name">MyAwesomeViewRoot</span><span class="token plain"> environment</span><span class="token operator" style="color:#b58a5e">=</span><span class="token punctuation" style="color:#b58a5e">{</span><span class="token plain">environment</span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">/</span><span class="token operator" style="color:#b58a5e">&gt;</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token function" style="color:black">expect</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">    renderer</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">root</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">find</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token parameter">item</span><span class="token plain"> </span><span class="token arrow operator" style="color:#b58a5e">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">props</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token property-access">testID</span><span class="token plain"> </span><span class="token operator" style="color:#b58a5e">=</span><span class="token plain"> </span><span class="token string" style="color:#65822b">&#x27;errorMessage&#x27;</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain">  </span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">.</span><span class="token method function property-access" style="color:black">toBeDefined</span><span class="token punctuation" style="color:#b58a5e">(</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain"></span><span class="token punctuation" style="color:#b58a5e">}</span><span class="token punctuation" style="color:#b58a5e">)</span><span class="token punctuation" style="color:#b58a5e">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:black"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/relay/tree/main/website/versioned_docs/version-v1.4.1/Modern-TestingRelayComponents.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-05-10T20:47:17.000Z">May 10, 2024</time></b> by <b>Paul Oâ€™Shannessy</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#testing-with-relay" class="table-of-contents__link toc-highlight">Testing with Relay</a></li><li><a href="#relaymockenvironment-api-overview" class="table-of-contents__link toc-highlight"><code>RelayMockEnvironment</code> API Overview</a></li><li><a href="#mock-payload-generator-and-relay_test_operation-directive" class="table-of-contents__link toc-highlight">Mock Payload Generator and <code>@relay_test_operation</code> Directive</a><ul><li><a href="#mock-resolver-context" class="table-of-contents__link toc-highlight">Mock Resolver Context</a></li><li><a href="#id-generation" class="table-of-contents__link toc-highlight">ID Generation</a></li><li><a href="#relay_test_operation" class="table-of-contents__link toc-highlight"><code>@relay_test_operation</code></a></li></ul></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a><ul><li><a href="#relay-component-test" class="table-of-contents__link toc-highlight">Relay Component Test</a></li><li><a href="#fragment-container-tests" class="table-of-contents__link toc-highlight">Fragment Container Tests</a></li><li><a href="#pagination-container-test" class="table-of-contents__link toc-highlight">Pagination Container Test</a></li><li><a href="#refetch-container" class="table-of-contents__link toc-highlight">Refetch Container</a></li><li><a href="#mutations" class="table-of-contents__link toc-highlight">Mutations</a></li><li><a href="#subscription" class="table-of-contents__link toc-highlight">Subscription</a></li><li><a href="#example-with-queueoperationresolver" class="table-of-contents__link toc-highlight">Example with <code>queueOperationResolver</code></a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/relay/docs/">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_self" href="/relay/users/">User Showcase</a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/relay/img/relay.svg" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/relay/img/relay.svg" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright Â© 2024 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/relay/assets/js/runtime~main.49921073.js"></script>
<script src="/relay/assets/js/main.f6618890.js"></script>
</body>
</html>